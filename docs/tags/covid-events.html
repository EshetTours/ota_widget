<covid-events class="mdc-image-list__item">
  <div class="chart block mdc-elevation--z1" if="{d.events}">
    <h2>
      {t('covid_events.title')} 
    </h2>
    <div id="covid_events-chart" style="width: 100%; height: 500px;"></div>
    <div class="mentions-row">
      <div class="mention" each="{m,i in mentions}">
        <div class="mention-meta">
          <div class="topic">
            <strong>{t('opinions.topics.'+m.topic, {default: m.label})} </strong>
          </div>
          <div class="times">
            {m.opinions_count} {t('mentions.times')} 
          </div>
        </div>
        <div class="mention-score {w.mentions.scoreClass(m)}">
          {w.mentions.scoreLabel(m)} 
        </div>
      </div>
    </div>
  </div>
  <script>
    this.w = window.ota_widget
    this.t = this.w.i18n.translate
    this.d = this.w.data
    
    this.topics = ['covid', 'sanitary_safety', 'health_precautions']
    
    this.on('update', function() {
      this.mentions = _.filter(this.d.mentions, function(m) {return _.includes(this.topics, m.topic)}.bind(this))
    })
  </script>
</covid-events>